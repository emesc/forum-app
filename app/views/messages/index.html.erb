<div id="calendar">
  <h2 id="month">
    <%= link_to "<<", :month => (@date.beginning_of_month-1).strftime("%Y-%m") %>
    <%=h @date.strftime("%b %Y") %>
    <%= link_to ">>", :month => (@date.end_of_month+1).strftime("%Y-%m") %>
  </h2>
  <%= calendar_for(@messages, :year => @date.year, :month => @date.month) do |calendar| %>
    <%= calendar.head('Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday') %>
    <%= calendar.day(:day_method => :published_on) do |date, messages| %>
      <%= date.day %>
      <ul>
        <%# messages.each do |message| %>
        <% for message in messages %>
          <li>
            <%= link_to h(message.title), message_path(message) %>  
          </li>
          
        <% end %>
      </ul>
    <% end %>
  <% end %>
</div>
